# Inspect Mode

Inspect mode allows users to see how their prompts are reshaped and verified by the prompting pipeline. This is useful for debugging, understanding pipeline behavior, and ensuring prompts are transformed as expected.

## Enabling Inspect Mode

### Via Commands

Add these commands to your message:

```
/show_prompt          - Show reshaped prompt details
/inspect_prompt       - Same as /show_prompt
```

Or use natural language at the end of your message:

```
What is quantum computing? inspect prompt
Explain machine learning show prompt
How does AI work? show reshaped
```

### Via Configuration

To allow inspect output to be included:

```bash
export PROMPTING_ALLOW_INSPECT_RESHAPED=true
```

## Inspect Output Format

When inspect is enabled, the output shows:

```
=== Prompt Inspection ===

ORIGINAL:
What is quantum computing?

RESHAPED:
Provide a comprehensive explanation of quantum computing.
Include: definition, key concepts (qubits, superposition, entanglement),
practical applications, and current limitations.
Target audience: technical but not expert.

VERIFICATION QUESTIONS:
  1. What is the basic definition of quantum computing?
  2. What are the key differences from classical computing?
  3. What are the main practical applications today?

FINDINGS:
  - Verified: Definition is accurate
  - Verified: Applications section is current

STATUS: Verified (3/3 checks passed)
```

## What Inspect Shows

| Section | Description |
|---------|-------------|
| ORIGINAL | Your original input before processing |
| RESHAPED | The optimized prompt sent to the LLM |
| VERIFICATION QUESTIONS | Questions generated by CoVe |
| FINDINGS | Summary of verification results |
| STATUS | Overall verification badge |

## What Inspect Never Shows

Inspect mode is designed to be concise and user-friendly. It **never** shows:

- Chain-of-thought reasoning
- Internal LLM prompts used for reshaping
- Raw verification answers
- Debug metadata or request IDs
- Pipeline timing or performance data

This keeps the output focused on what matters: understanding how your prompt was transformed.

## Usage in Code

```python
from prompting import PromptingPipeline, PromptingConfig

config = PromptingConfig(
    enable_prompt_reshape=True,
    enable_cove=True,
    allow_user_inspect_reshaped_prompt=True,  # Required for inspect
)
pipeline = PromptingPipeline(config=config)

# Request with inspect enabled
result = pipeline.run(
    "What is AI?",
    include_reshaped_prompt=True,
)

if result.reshaped_prompt:
    print(result.reshaped_prompt)  # Formatted inspect output
```

## InspectOutput Type

The inspect output is generated using the `InspectOutput` dataclass:

```python
@dataclass
class InspectOutput:
    original_prompt: str
    reshaped_prompt: str
    verification_questions: list[str]
    findings_summary: list[str]
    badge: Optional[str]

    def format(self) -> str:
        """Format for display - never shows chain-of-thought."""
```

## Integration with NEXUS

When using NEXUS, inspect information is available in the Response:

```python
response = nexus.process_message("What is AI? /show_prompt")

# Access inspect info
print(response.text)           # Main response
print(response.reshaped_from)  # Formatted inspect output
print(response.verified_badge) # Verification status
```

## Disabling Inspect

To completely disable inspect capability:

```bash
export PROMPTING_ALLOW_INSPECT_RESHAPED=false
```

When disabled:
- `/show_prompt` commands are ignored
- `include_reshaped_prompt=True` has no effect
- No inspect output is generated

This is useful for production deployments where you don't want to expose internal prompt transformations.

## Security Considerations

- Inspect output does not expose sensitive configuration
- LLM API keys and internal prompts are never shown
- Only the user-facing transformation is displayed
- Consider disabling in production if prompt strategies are confidential

## Related Documentation

- [Prompting Pipeline](./PROMPTING_PIPELINE.md) - How reshaping works
- [CoVe Verification](./COVE_VERIFICATION.md) - How verification works
